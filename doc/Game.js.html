<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controller/Game.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controller/Game.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module
 */
define([
  'lodash',
  'maze/creator',
  'model/Game',
  'view/Game',
], function(_, maze, GameModel, GameView) {
  'use strict';

  /**
   * @constructor
   * @this {module:controller/Game}
   */
  var exports = function() {
    // Generate a maze and gets is components
    var mazeComponents = maze.create();

    // Create the game model from the maze components
    this.model = this.__initModel(mazeComponents);

    // Create the view that will render the game model on the screen
    this.view = this.__initView(this.model);

    // Start the render loop
    this.view.render();
  };

  /**
   * Create the game model and its components.
   *
   * @private
   * @param {Object} mazeComponents The components that make up the labyrinth.
   * @param mazeComponents.walls An array of the walls.
   * @param mazeComponents.walls.x
   * @param mazeComponents.walls.y
   * @param mazeComponents.walls.width
   * @param mazeComponents.walls.height
   * @param mazeComponents.start Where the ball should start
   * @param mazeComponents.start.x
   * @param mazeComponents.start.y
   * @param mazeComponents.exitPath An array of object that make up the exit
   *   path that the player should follow to reach the goal.
   * @param mazeComponents.exitPath.x
   * @param mazeComponents.exitPath.y
   * @returns {module:model/Game}
   */
  exports.prototype.__initModel = function(mazeComponents) {
    var gameModel = new GameModel();

    // Create the container edges
    gameModel.createContainer(10, 10);

    // Init ball
    gameModel.createBall({
      x: mazeComponents.start.x,
      y: mazeComponents.start.y
    });

    // Init walls
    _.forEach(mazeComponents.walls, function(wall) {
      gameModel.createWall({
        // The maze module defines the (X, Y) coordinate as the bottom left
        // corner of the wall cell, while Box2D and THREE define it as the
        // center of the object.
        x: wall.x + wall.width / 2,
        y: wall.y + wall.height / 2,
        width: wall.width,
        height: wall.height,
      });
    }.bind(this));

    // Init obstacles
    _.forEach(
      mazeComponents.obstacles,
      gameModel.createObstacle.bind(gameModel)
    );

    // Store the exit path in the model
    gameModel.addExitPath(_.map(mazeComponents.exitPath, function(pathCell) {
      // Move the coordinate to the center of the cell; see the comment above
      // about the walls and their coordinates.
      return {x: pathCell.x + 0.5, y: pathCell.y + 0.5};
    }));

    return gameModel;
  };

  /**
   * Create the game view.
   *
   * @private
   * @param {module:model/Game} model The game model that the view should show
   *  on the screen.
   * @returns {module:view/Game}
   */
  exports.prototype.__initView = function(model) {
    return new GameView(model);
  };

  return exports;
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="Game.html">controller/Game</a></li><li><a href="Key.html">input/Key</a></li><li><a href="creator.html">maze/creator</a></li><li><a href="longestPathFinder.html">maze/longestPathFinder</a></li><li><a href="matrixMaze.html">maze/matrixMaze</a></li><li><a href="obstaclePlacer.html">maze/obstaclePlacer</a></li><li><a href="wallExtractor.html">maze/wallExtractor</a></li><li><a href="Game_.html">model/Game</a></li><li><a href="PriorityQueue.html">structs/PriorityQueue</a></li><li><a href="Game__.html">view/Game</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Fri Aug 29 2014 11:47:38 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
