<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: maze/wallExtractor.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: maze/wallExtractor.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * This module extracts the walls from a matrix maze with each wall as an
 * object.
 *
 * @example
 * // Example usage
 * wallExtractor.extract(maze);
 * // Returns:
 * [{height: 1, width: 1, x: 0, y: 6}, {height: 5, width: 1, x: 1, y: 0}, ...]
 *
 * // Where the maze looks like:
 * matrixMaze.printMatrix(maze)
 * -W----##--
 * -W-##---#-
 * -W-##-#---
 * -W---#-#-#
 * -W##-#-#--
 * -----#-##-
 * W-##-#----
 * -#--#--###
 * ---##-##--
 * -#-------#
 * // The two walls from the extract function shown above have been highlighted
 * // with W characters
 *
 * @module
 */
define([
  'lodash',
], function(_) {
  'use strict';

  var exports = {

    /**
     * Add sentinel nodes to the end of the columns and rows.
     *
     * &lt;p>All of these added nodes are floor nodes and they are put in to make
     * the loops in this module easier to work with. With these sentinel nodes
     * there is no need to handle the last cell in a row or column in a special
     * way.&lt;/p>
     *
     * @param {Array.&lt;Array.&lt;Object>>} maze A maze matrix.
     * @param maze.wall {boolean}
     */
    __addSentinelCells: function(maze) {
      // Add a sentinel cell to each row
      _.forEach(maze, function(row) {
        row.push({wall: false});
      });

      // Add a sentinel row
      maze.push(_.map(new Array(maze[0].length), function() {
        return {wall: false};
      }));
    },

    /**
     * Get the horizontal wall starting at (y, x) and as long as possible with
     * increasing x values.
     *
     * @param {Array.&lt;Array.&lt;Object>>} maze A maze matrix.
     * @param maze.wall {boolean}
     * @param {number} y
     * @param {number} x
     * @returns {Array.&lt;Object>} An array of objects with x and y coordinates.
     */
    __getHorizontalWallStrip: function(maze, y, x) {
      var wall = [];
      for (var columnIndex = x; columnIndex &lt; maze[0].length; ++columnIndex) {
        var cell = maze[y][columnIndex];
        if (cell.wall) {
          wall.push({y: y, x: columnIndex});
        } else {
          return wall;
        }
      }
    },


    /**
     * Get the vertical wall starting at (y, x) and as long as possible with
     * increasing y values.
     *
     * @param {Array.&lt;Array.&lt;Object>>} maze A maze matrix.
     * @param maze.wall {boolean}
     * @param {number} y
     * @param {number} x
     * @returns {Array.&lt;Object>} An array of objects with x and y coordinates.
     */
    __getVerticalWallStrip: function(maze, y, x) {
      var wall = [];
      for (var rowIndex = y; rowIndex &lt; maze.length; ++rowIndex) {
        var cell = maze[rowIndex][x];
        if (cell.wall) {
          wall.push({y: rowIndex, x: x});
        } else {
          return wall;
        }
      }
    },

    /**
     * @param {Array.&lt;Array.&lt;Object>>} maze A maze matrix.
     * @param maze.wall {boolean}
     * @param {Array.&lt;Object>} wall An array of wall cells to change to floors.
     * @param wall.x {number}
     * @param wall.y {number}
     */
    __removeWall: function(maze, wall) {
      _.forEach(wall, function(cell) {
        maze[cell.y][cell.x].wall = false;
      });
    },

    /**
     * Extract the walls from a matrix maze.
     *
     * @param {Array&lt;Array&lt;Object>>} maze A matrix maze.
     * @returns {Array&lt;Object>} A list of wall objects with attributes `x`,
     *   `y`, `width` and `height`.
     */
    extract: function(maze) {
      // Make a copy of the maze
      maze = _.clone(maze, true);
      this.__addSentinelCells(maze);

      var walls = [];

      for (var columnIndex = 0; columnIndex &lt; maze[0].length - 1; ++columnIndex) {
        for (var rowIndex = 0; rowIndex &lt; maze.length - 1; ++rowIndex) {
          if (!maze[rowIndex][columnIndex].wall) {
            // Ignore the cell if it's a floor tile
            continue;
          }
          // Get a horizontal wall starting at the current cell
          var horizontalWall = this.__getHorizontalWallStrip(
            maze, rowIndex, columnIndex
          );
          // Get a vertical wall starting at the current cell
          var verticalWall = this.__getVerticalWallStrip(
            maze, rowIndex, columnIndex
          );
          var longestWall;
          if (horizontalWall.length >= verticalWall.length) {
            longestWall = horizontalWall;
            walls.push({
              y: rowIndex,
              x: columnIndex,
              width: longestWall.length,
              height: 1
            });
          } else {
            longestWall = verticalWall;
            walls.push({
              y: rowIndex,
              x: columnIndex,
              width: 1,
              height: longestWall.length
            });
          }
          // Remove the picked wall from the maze so none of its cells are
          // unnecessarily added in multple walls
          this.__removeWall(maze, longestWall);
        }
      }

      return walls;
    },
  };

  return exports;
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="Game.html">controller/Game</a></li><li><a href="Key.html">input/Key</a></li><li><a href="creator.html">maze/creator</a></li><li><a href="longestPathFinder.html">maze/longestPathFinder</a></li><li><a href="matrixMaze.html">maze/matrixMaze</a></li><li><a href="obstaclePlacer.html">maze/obstaclePlacer</a></li><li><a href="wallExtractor.html">maze/wallExtractor</a></li><li><a href="Game_.html">model/Game</a></li><li><a href="PriorityQueue.html">structs/PriorityQueue</a></li><li><a href="Game__.html">view/Game</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Fri Aug 29 2014 11:47:38 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
